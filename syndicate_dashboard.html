<!DOCTYPE html>
<html>
<head>
  <title>Syndicate Dashboard</title>
  <style>
    body { font-family: Arial; background: #111; color: #eee; padding: 20px; }
    h1, h2 { color: #0ff; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #444; padding: 8px; text-align: left; }
    th { background: #222; }
    .verified { color: #0f0; }
    .flagged { color: #ff0; }
    .unmatched { color: #f00; }
    .assertion { background: #222; padding: 10px; margin-top: 20px; border: 1px solid #444; }
  </style>
</head>
<body>
  <h1>Syndicate Dashboard</h1>
  <div id="summary"></div>
  <div id="runs"></div>
  <div id="assertions"></div>
  <script>
    fetch('output/scan_results.json')
      .then(res => res.json())
      .then(data => {
        let verified = 0, flagged = 0, unmatched = 0;
        let assertions = { TrustID: [], UCCRef: [], StateAgency: [], NamespaceID: [] };

        const table = document.createElement('table');
        table.innerHTML = "<tr><th>Identifier</th><th>Status</th><th>Reason</th></tr>";

        data.forEach(item => {
          if (item.status === "verified") {
            verified++;
            if (item.identifier.startsWith("TR-")) assertions.TrustID.push(item.identifier);
            else if (item.identifier.startsWith("CA-UCC-")) assertions.UCCRef.push(item.identifier);
            else if (item.identifier.startsWith("STATE-")) assertions.StateAgency.push(item.identifier);
            else if (item.identifier.startsWith("NS-")) assertions.NamespaceID.push(item.identifier);
          } else if (item.status === "flagged") flagged++;
          else unmatched++;

          const row = document.createElement('tr');
          row.innerHTML = <td></td>
                           <td class=""></td>
                           <td></td>;
          table.appendChild(row);
        });

        document.getElementById("runs").appendChild(table);
        document.getElementById("summary").innerHTML = 
          <p>Total Scanned: </p>
          <p class='verified'>Verified: </p>
          <p class='flagged'>Flagged: </p>
          <p class='unmatched'>Unmatched: </p>
        ;

        let assertionHTML = "<h2>Symbolic Assertions</h2>";
        for (const [type, ids] of Object.entries(assertions)) {
          if (ids.length > 0) {
            assertionHTML += <div class='assertion'><strong></strong><ul>;
            ids.forEach(id => {
              assertionHTML += <li> — <span class='verified'>Verified </span></li>;
            });
            assertionHTML += "</ul></div>";
          }
        }
        document.getElementById("assertions").innerHTML = assertionHTML;
      });
  </script>
</body>
</html>
