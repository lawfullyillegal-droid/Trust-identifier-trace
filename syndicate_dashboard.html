<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Syndicate Dashboard</title>
  <style>
    body { font-family: Arial; background: #111; color: #eee; padding: 20px; }
    h1, h2 { color: #0ff; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #444; padding: 8px; text-align: left; }
    th { background: #222; }
    .verified { color: #0f0; }
    .flagged { color: #ff0; }
    .unmatched { color: #f00; }
    .error { color: #f00; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Syndicate Dashboard</h1>
  <div id="summary"></div>
  <div id="runs"></div>
  <div id="error" class="error"></div>
  <script>
    const archiveFiles = [
      "output/scan_results.json",
      "archive/scan_results_20250830-1049.json",
      "archive/scan_results_20250830-1050.json"
    ];

    let total = 0, verified = 0, flagged = 0, unmatched = 0;

    archiveFiles.forEach((path, index) => {
      fetch(path)
        .then(res => {
          if (!res.ok) throw new Error("File not found: " + path);
          return res.json();
        })
        .then(data => {
          total += data.length;
          let runHTML = `<h2>Run ${index + 1}: </h2><table><tr><th>Identifier</th><th>Status</th><th>Reason</th></tr>`;
          data.forEach(item => {
            if (item.status === "verified") verified++;
            else if (item.status === "flagged") flagged++;
            else unmatched++;
            runHTML += `<tr>
                          <td>${item.identifier || 'N/A'}</td>
                          <td class="${item.status}">${item.status || 'unknown'}</td>
                          <td>${item.reason || item.source || 'N/A'}</td>
                        </tr>`;
          });
          runHTML += "</table>";
          document.getElementById("runs").innerHTML += runHTML;
          document.getElementById("summary").innerHTML = 
            `<p>Total Identifiers Scanned: ${total}</p>
            <p class='verified'>Verified: ${verified}</p>
            <p class='flagged'>Flagged: ${flagged}</p>
            <p class='unmatched'>Unmatched: ${unmatched}</p>`;
        })
        .catch(err => {
          document.getElementById("error").innerHTML += `<p>Error loading ${path}: ${err.message}</p>`;
        });
    });
  </script>
</body>
</html>
